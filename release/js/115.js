!function(){"use strict";var t=function(){this.context=document.querySelector('iframe[rel="wangpan"]').contentDocument};t.prototype.showToast=function(t){var e=t.message,o=t.type;window.Core.MinMessage.Show({text:e,type:o,timeout:1e3})},t.prototype.startListen=function(){var t=this;window.addEventListener("message",(function(e){e.data.type&&"getSelected"===e.data.type&&window.postMessage({type:"selected",data:t.getSelected()},location.origin),e.data.type&&"getHovered"===e.data.type&&window.postMessage({type:"hovered",data:t.getHovered()},location.origin),e.data.type&&"showToast"===e.data.type&&t.showToast(e.data.data),e.data.type&&"refresh"===e.data.type&&t.refresh()}))},t.prototype.refresh=function(){this.context=document.querySelector('iframe[rel="wangpan"]').contentDocument},t.prototype.getFileInfoFromElements=function(t){var e=[];return Array.from(t).forEach((function(t){var o=t.getAttribute("file_type");"1"===o&&e.push({isdir:!1,sha1:t.getAttribute("sha1"),pick_code:t.getAttribute("pick_code"),path:""}),"0"===o&&e.push({isdir:!0,cate_id:t.getAttribute("cate_id"),path:""})})),e},t.prototype.getSelected=function(){var t=this.context.querySelectorAll('li[rel="item"].selected');return this.getFileInfoFromElements(t)},t.prototype.getHovered=function(){var t=this.context.querySelectorAll('li[rel="item"].hover');return this.getFileInfoFromElements(t)},(new t).startListen()}();